<!doctype html>
<html lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Ready.Work Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Ready.Work Blog Atom Feed"><title data-react-helmet="true">数据库-基础应用 | Ready.Work</title><meta data-react-helmet="true" property="og:url" content="https://lyuweihua.github.io/zh-CN/docs/database"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-CN"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="数据库-基础应用 | Ready.Work"><meta data-react-helmet="true" name="description" content="配置"><meta data-react-helmet="true" property="og:description" content="配置"><link data-react-helmet="true" rel="shortcut icon" href="/zh-CN/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://lyuweihua.github.io/zh-CN/docs/database"><link data-react-helmet="true" rel="alternate" href="https://lyuweihua.github.io/docs/database" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://lyuweihua.github.io/zh-CN/docs/database" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://lyuweihua.github.io/docs/database" hreflang="x-default"><link rel="stylesheet" href="/zh-CN/assets/css/styles.3aee0be5.css">
<link rel="preload" href="/zh-CN/assets/js/styles.96f10285.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.419365fc.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.aa12cbc9.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/1.546c467a.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/2.b134721d.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/62.1a0d5637.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/64.5d0d37cb.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/935f2afb.305cabed.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/17896441.b6f4f76e.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/6a8a6f76.60bf0d64.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><img src="/zh-CN/img/ready.png" alt="Ready.Work Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh-CN/img/ready.png" alt="Ready.Work Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Ready.Work</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-CN/docs/">开发文档</a><a class="navbar__item navbar__link" href="/zh-CN/blog">开发动态</a><a class="navbar__item navbar__link" href="/zh-CN/hardware">配套硬件</a><a class="navbar__item navbar__link" href="/zh-CN/why">开发缘由</a><a class="navbar__item navbar__link" href="/zh-CN/shoulder">巨人的肩膀</a><a class="navbar__item navbar__link" href="/zh-CN/coming">开源计划</a><a class="navbar__item navbar__link" href="/zh-CN/medicine">医学探索</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>zh-CN</span></span></a><ul class="dropdown__menu"><li><a href="/docs/database" target="_self" rel="noopener noreferrer" class="dropdown__link">en</a></li><li><a href="/zh-CN/docs/database" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">zh-CN</a></li></ul></div><a href="https://github.com/LyuWeihua/ReadyWork" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/zh-CN/"><img src="/zh-CN/img/ready.png" alt="Ready.Work Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh-CN/img/ready.png" alt="Ready.Work Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Ready.Work</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/zh-CN/docs/">开发文档</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/blog">开发动态</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/hardware">配套硬件</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/why">开发缘由</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/shoulder">巨人的肩膀</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/coming">开源计划</a></li><li class="menu__list-item"><a class="menu__link" href="/zh-CN/medicine">医学探索</a></li><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/docs/database" target="_self" rel="noopener noreferrer" class="menu__link">en</a></li><li class="menu__list-item"><a href="/zh-CN/docs/database" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active">zh-CN</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/LyuWeihua/ReadyWork" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">单体应用(Monolithic)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/">快速开始</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/install">安装</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/configuration">配置</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/logger">日志</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/aop">依赖注入/切面编程</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/controller">控制器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/validator">参数校验器</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/zh-CN/docs/database">数据库-基础应用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/database-auto">数据库-Auto注解</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/database-advanced">数据库-高级应用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/modulization">应用模块化</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/event">事件驱动</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/security">安全策略</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/cache">缓存服务</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/websocket">Websocket</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/time-uuid">时间服务/UUID服务</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/i18n">国际化支持</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">微服务应用(Microservices)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/cloud-get-started">快速开始</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/cloud-node-discovery">节点发现</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/cloud-microservice">微服务应用</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/cloud-config-service">配置服务</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/common-transaction">事务参考知识</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/cloud-distributed-transaction">分布式事务</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/cloud-distributed-database">分布式数据库</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">并行计算(Parallel Computing)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/parallel-computing">并行计算</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/parallel-ai">并行AI训练</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/zh-CN/docs/federated-learning">联邦学习</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">数据库-基础应用</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="配置"></a>配置<a class="hash-link" href="#配置" title="Direct link to heading">#</a></h2><ol><li>通过YAML配置文件</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># configuration for dev environment</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">readyWork</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># This is the default binding address.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">ip</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 0.0.0.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Http port if enableHttp is true.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">httpPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8080</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">database</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">sqlDebug</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># SQL调试，输出SQL到日志</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">dataSource</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 所有的数据源需要配置在dataSource下面</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">main</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 主数据源固定名称为&quot;main&quot;，其他数据源名称自定义</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mysql </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 类型支持H2、Mysql、Postgre、Oracle、SqlServer、Sqlite、Ignite，当前版本强烈推荐Mysql，其他类型尚未进行严格测试。</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#driverClass: com.mysql.cj.jdbc.Driver  #since mysql jdbc 8, The driver is automatically registered via the SPI</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">jdbcUrl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> jdbc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">mysql</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">//127.0.0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">3306/test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">?</span><span class="token plain">useUnicode=true</span><span class="token important">&amp;useSSL=false&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">username</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> root</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">password</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">12345678</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#autoMapping: true # 自动映射，默认开启</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#table: demo # 单数据源或者程序手工映射时不需要此设定，只有多数据源时，自动映射模型需要明确模型表和数据源的关系，自动映射时，多数据源的表名不能重复，后续会改进该问题</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#ignoreTable: xxx # 忽略某些表，如果有某些表是不需要该项目访问</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">#sqlTemplatePath: /sql/ # SQL模版文件路径，相对于项目工作空间路径，如果设置了此项，下面的sqlTemplate就相对于此路径</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">sqlTemplate</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> sql/demo.sql </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 需要加载的SQL模版文件，如果上面sqlTemplatePath没有指明路径，这里需要带上相对于项目工作空间的路径</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="2"><li>通过程序配置</li></ol><p>基本上Boostrap中的配置项都可以通过globalConfig进行程序化配置，数据库配置也不例外。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Main extends Application {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    protected void globalConfig(ApplicationConfig config) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 配置文件中的配置项，都可以通过程序化配置完成，上面通过YAMl配置了main数据源并加载了demo.sql模版，这里通过程序配置了test数据源并加载test.sql模版</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        config.getDatabase().setDataSource(&quot;test&quot;, new DataSourceConfig()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                //.setType(DataSourceConfig.TYPE_MYSQL) // mysql是默认项，这里可以不用指定</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                .setJdbcUrl(&quot;jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                .setUsername(&quot;root&quot;).setPassword(&quot;12345678&quot;).setSqlTemplate(&quot;sql/test.sql&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    protected void initialize() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 如果配置中关闭了autoMapping，那么通过这里进行数据模型映射。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // dbManager().getDatasourceAgent(&quot;main&quot;).addMapping(&quot;demo&quot;, Demo.class);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void main(String[] args) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Ready.For(Main.class).Work(args);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="演示数据"></a>演示数据<a class="hash-link" href="#演示数据" title="Direct link to heading">#</a></h2><p>请先建立一个test的数据库，然后导入下面的demo表结构和数据。或者直接导入demo.sql，文件在examples\quickstart示例包中的resources文件夹。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly mysql"><div tabindex="0" class="prism-code language-mysql codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SET NAMES utf8mb4;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SET FOREIGN_KEY_CHECKS = 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- ----------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Table structure for demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- ----------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DROP TABLE IF EXISTS `demo`;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">CREATE TABLE `demo` (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `id` int NOT NULL AUTO_INCREMENT,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `name` varchar(20) DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `gender` int DEFAULT &#x27;1&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `age` int DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `height` int DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `weight` int DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `hobbies` text,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `created` datetime DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `modified` datetime DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `status` int DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `isDeleted` bit(1) DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  `version` int DEFAULT NULL,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  PRIMARY KEY (`id`)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- ----------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- Records of demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">-- ----------------------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BEGIN;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (1, &#x27;Jimmy&#x27;, 1, 18, 170, 65, &#x27;Study&#x27;, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (2, &#x27;name2&#x27;, 0, 18, 170, 68, &#x27;PC Games&#x27;, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (3, &#x27;name3&#x27;, 1, 20, 168, 65, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (4, &#x27;name4&#x27;, 0, 20, 172, 70, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (5, &#x27;name5&#x27;, 1, 22, 170, 72, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (6, &#x27;name6&#x27;, 0, 23, 165, 60, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (7, &#x27;name7&#x27;, 1, 25, 175, 80, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (8, &#x27;name8&#x27;, 0, 25, 172, 75, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (9, &#x27;name9&#x27;, 1, 26, 160, 60, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (10, &#x27;name10&#x27;, 0, 28, 165, 68, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (11, &#x27;name11&#x27;, 1, 28, 168, 65, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (12, &#x27;name12&#x27;, 1, 28, 172, 72, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (13, &#x27;name13&#x27;, 0, 30, 175, 75, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (14, &#x27;name14&#x27;, 1, 30, 168, 80, &#x27;Sports&#x27;, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (15, &#x27;name15&#x27;, 1, 32, 165, 60, &#x27;Study&#x27;, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (16, &#x27;name16&#x27;, 0, 33, 178, 75, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (17, &#x27;name17&#x27;, 1, 33, 180, 80, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (18, &#x27;name18&#x27;, 1, 20, 175, 72, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (19, &#x27;name19&#x27;, 0, 36, 168, 60, NULL, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INSERT INTO `demo` VALUES (20, &#x27;name20&#x27;, 1, 36, 172, 65, &#x27;Chess&#x27;, &#x27;2021-08-08 08:08:08&#x27;, &#x27;2021-08-08 08:08:08&#x27;, 1, b&#x27;0&#x27;, 0);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">COMMIT;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SET FOREIGN_KEY_CHECKS = 1;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="基本使用"></a>基本使用<a class="hash-link" href="#基本使用" title="Direct link to heading">#</a></h2><p>不使用任何高级特性，直接操作数据库表。可以直接获取DB实例进行各类基础SQL操作。以下是一组对数据库进行基本增删改查的操作实例：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class BasicDemoService {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 默认数据源是当前数据源，通常是主数据源main</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    private static Db db = Ready.dbManager().getDb();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 返回结果是Record类型，基础数据库查询的结果集都将以Record类型存在，它是一个基于Map的容器。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Record getByName(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var sql = &quot;select * from demo where name = ? limit 1&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.findFirst(sql, name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 多数据源可以随时切换，db.use(&quot;test&quot;)切换到test数据源</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Record getByNameFromTest(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var sql = &quot;select * from demo where name = ? limit 1&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.use(&quot;test&quot;).findFirst(sql, name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 返回多行数据时，以List&lt;Record&gt;形式返回</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public List&lt;Record&gt; getAllByAge(int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var sql = &quot;select * from demo where age &gt; ?&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.find(sql, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 翻页查询时，以Page&lt;Record&gt;形式返回，注意SQL语句分拆</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Record&gt; getPageByAge(int page, int size, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.paginate(page, size, &quot;select *&quot;, &quot;from demo where age &gt; ?&quot;, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 翻页查询支持GROUP BY，注意SQL语句分拆，MYSQL服务器需要关闭ONLY_FULL_GROUP_BY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Record&gt; getPageByAgeWithGroupBy(int page, int size, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.paginate(page, size, true, &quot;select *&quot;, &quot;from demo where age &gt; ? group by age&quot;, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 翻页查询，完全自定义SQL查询，上面的查询会自动进行select count(*) ...查询，这里可以完全按需自定义</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Record&gt; getPageByFullSql(int page, int size, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String from = &quot;from demo where age &gt; ?&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String totalRowSql = &quot;select count(*) &quot; + from;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String findSql = &quot;select * &quot; + from + &quot; order by age&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.paginateByFullSql(page, size, totalRowSql, findSql, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 添加一行数据，纯SQL操作</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int insertBySql(){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.update(&quot;insert into demo (name, gender, age, height, weight) values(?,?,?,?,?)&quot;, &quot;test&quot;, 1, 20, 170, 65);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 添加一行数据，通过record对象操作</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public boolean insertByRecord(){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.save(&quot;demo&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                db.record(Map.of(&quot;name&quot;,&quot;test&quot;, &quot;gender&quot;, 1, &quot;age&quot;, 20, &quot;height&quot;, 170, &quot;weight&quot;, 65)));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 修改数据，纯SQL操作</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int updateAgeBySql(String name, int age){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.update(&quot;update demo set age = ? where name = ?&quot;, age, name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 修改数据，先查询出record记录列，再通过record对象进行更新，这种操作模式表的主键列名必须统一为&quot;id&quot;，后续会改进</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int updateAgeByRecord(String name, int age){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var list = db.find(&quot;select * from demo where name = ?&quot;, name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int count = 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        for(Record record : list) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if(db.update(&quot;demo&quot;, record.set(&quot;age&quot;, age))){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                count ++;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return count;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 修改一行数据，通过主键结合record对象操作，，这种操作模式表的主键列名必须统一为&quot;id&quot;，后续会改进</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public boolean updateAgeByRecordId(int id, int age){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.update(&quot;demo&quot;, db.record().set(&quot;id&quot;, id).set(&quot;age&quot;, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 删除数据，纯SQL操作</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int deleteBySql(){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.delete(&quot;delete from demo where name = ?&quot;, &quot;test&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 删除数据，先查询出record记录列，再通过record对象进行删除，这种操作模式表的主键列名必须统一为&quot;id&quot;，后续会改进</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public int deleteByRecord() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var list = db.find(&quot;select * from demo where name = ?&quot;, &quot;test&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int count = 0;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        for(Record record : list) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            if(db.delete(&quot;demo&quot;, record)){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                count ++;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return count;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 删除一行数据，通过主键结合record对象操作，这种操作模式表的主键列名必须统一为&quot;id&quot;，后续会改进</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public boolean deleteByRecordId(int id){</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.delete(&quot;demo&quot;, db.record().set(&quot;id&quot;, id));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>例子中默认使用当前数据源，通常是主数据源main，如果有多个数据源或者需要切换数据源，可以通过db.use(&quot;数据源名称&quot;)动态切换。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@RequestMapping(value = &quot;/basic/&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class BasicController extends Controller {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    private BasicDemoService demoService;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;String&gt; index() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(&quot;hello world !&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Record&gt; getByName() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByName(name));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Record&gt; getByNameFromTest() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByNameFromTest(name));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;List&lt;Record&gt;&gt; getAllByAge() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getAllByAge(age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Record&gt;&gt; getPageByAge() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getPageByAge(page, size, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Record&gt;&gt; getPageByAgeWithGroupBy() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getPageByAgeWithGroupBy(page, size, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Record&gt;&gt; getPageByFullSql() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getPageByFullSql(page, size, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.POST)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Integer&gt; insertBySql() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.insertBySql());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.POST)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; insertByRecord() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.insertByRecord());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.PUT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Integer&gt; updateAgeBySql() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.updateAgeBySql(name, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.PUT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Integer&gt; updateAgeByRecord() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.updateAgeByRecord(name, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.PUT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; updateAgeByRecordId() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int id = Assert.notNull(getParamToInt(&quot;id&quot;), &quot;id is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.updateAgeByRecordId(id, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.DELETE)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Integer&gt; deleteBySql() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.deleteBySql());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.DELETE)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Integer&gt; deleteByRecord() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.deleteByRecord());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.DELETE)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; deleteByRecordId() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int id = Assert.notNull(getParamToInt(&quot;id&quot;), &quot;id is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.deleteByRecordId(id));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>创建一个Controller来使用上面的BasicDemoService，通过访问<code>http://127.0.0.1:8080/basic/...</code>即可查看结果。</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="代码生成器"></a>代码生成器<a class="hash-link" href="#代码生成器" title="Direct link to heading">#</a></h2><p>数据库表结构创建好后，可以通过代码生成器自动生成表模型，方便进行快速业务开发，请看下面的例子：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class CodeGenerator {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 这里一共实现了3各版本的代码生成方法，由简单到定制化的进行了演示</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void main(String[] args) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        customizedWithPath(); // 根据需要选择生成方案</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 最简单的生成器，定义好模型和服务类的包名，自动生成代码到当前项目中</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void easy() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String modelPackage = &quot;work.ready.test.model&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String servicePackage = &quot;work.ready.test.service&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 下面默认使用bootstrap.yml中的main数据库配置，针对main数据源下的所以表</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var generator = new Generator(DatabaseManager.MAIN_CONFIG_NAME, modelPackage, servicePackage);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        generator.generate();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 定制生成器，定义好模型和服务类的包名，自动生成代码到当前项目中</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void customized() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String modelPackage = &quot;work.ready.test.model&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String baseModelPackage = modelPackage + &quot;.base&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String servicePackage = &quot;work.ready.test.service&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 下面默认使用bootstrap.yml中的main数据库配置，针对main数据源下的所以表</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var generator = new Generator(Generator.getMainDatasource(), Generator.getMainMetaBuilder(),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new BaseModelGenerator(baseModelPackage),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new ModelGenerator(modelPackage, baseModelPackage),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new ServiceInterfaceGenerator(servicePackage, modelPackage), //如果不需要生成service，可以为null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new ServiceImplGenerator(servicePackage, modelPackage)  //如果不需要生成service，可以为null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        generator.generate();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 定制生成器，定义好模型和服务类的包名，自动生成代码到指定路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void customizedWithPath() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String modelPackage = &quot;work.ready.test.model&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String baseModelPackage = modelPackage + &quot;.base&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String servicePackage = &quot;work.ready.test.service&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 定义各类型代码的保存路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String path = PathUtil.getProjectRootPath() + &quot;/src/test/java/&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String baseModelPath = path + baseModelPackage.replace(&quot;.&quot;, &quot;/&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String modelPath = path + modelPackage.replace(&quot;.&quot;, &quot;/&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String servicePath = path + servicePackage.replace(&quot;.&quot;, &quot;/&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String serviceImplPath = path + (servicePackage + &quot;.impl&quot;).replace(&quot;.&quot;, &quot;/&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 下面默认使用bootstrap.yml中的main数据库配置，针对main数据源下的所以表</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String ds = &quot;main&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var generator = new Generator(Generator.getDatasource(ds), Generator.getMetaBuilder(ds),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new BaseModelGenerator(baseModelPackage, baseModelPath),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new ModelGenerator(modelPackage, baseModelPackage, modelPath),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new ServiceInterfaceGenerator(servicePackage, modelPackage, servicePath),  //如果不需要生成service，可以为null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                new ServiceImplGenerator(servicePackage, modelPackage, serviceImplPath)  //如果不需要生成service，可以为null</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        generator.setGenerateDataDictionary(true);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        generator.setGenerateRemarks(true);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        generator.generate();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="模型应用"></a>模型应用<a class="hash-link" href="#模型应用" title="Direct link to heading">#</a></h2><p>使用模型操作比直接数据库访问更加便捷，能通过操作对象属性方式对数据字段进行操作，且拥有更多扩展功能。应用模型需要先建立表的模型并进行表关系映射，建立表模型通常由代码生成器完成，生成器会为每张表生成2个Java类文件。如下所示：</p><div class="codeBlockContainer_K1bP"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_eoMF">BaseDemo.java</div><div class="codeBlockContent_hGly java"><div tabindex="0" class="prism-code language-java codeBlock_23N8 thin-scrollbar codeBlockWithTitle_2JqI"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Generated by Ready.Work</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@SuppressWarnings(&quot;serial&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public abstract class BaseDemo&lt;M extends BaseDemo&lt;M&gt;&gt; extends Model&lt;M&gt; implements Bean {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setId(Integer id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;id&quot;, id);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Integer getId() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getInt(&quot;id&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setName(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;name&quot;, name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public String getName() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getStr(&quot;name&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setGender(Integer gender) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;gender&quot;, gender);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Integer getGender() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getInt(&quot;gender&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setAge(Integer age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;age&quot;, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Integer getAge() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getInt(&quot;age&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setHeight(Integer height) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;height&quot;, height);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Integer getHeight() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getInt(&quot;height&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setWeight(Integer weight) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;weight&quot;, weight);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Integer getWeight() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getInt(&quot;weight&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setHobbies(String hobbies) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;hobbies&quot;, hobbies);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public String getHobbies() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getStr(&quot;hobbies&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setCreated(java.util.Date created) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;created&quot;, created);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public java.util.Date getCreated() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return get(&quot;created&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setModified(java.util.Date modified) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;modified&quot;, modified);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public java.util.Date getModified() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return get(&quot;modified&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setStatus(Integer status) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;status&quot;, status);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Integer getStatus() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getInt(&quot;status&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setIsDeleted(Boolean isDeleted) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;isDeleted&quot;, isDeleted);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Boolean getIsDeleted() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return get(&quot;isDeleted&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public M setVersion(Integer version) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        set(&quot;version&quot;, version);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return (M)this;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Integer getVersion() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return getInt(&quot;version&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">上面这个BaseDemo类文件是对应表的模型基础类，不要对它做任何修改或增强，如果数据库结构有变更，重新生成覆盖该文件即可。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```java title=&quot;Demo.java&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Generated by Ready.Work</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Table(tableName = &quot;demo&quot;, primaryKey = &quot;id&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Demo extends BaseDemo&lt;Demo&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">这个Demo类文件是方便对模型进行扩展的类，如果有需要对模型进行扩展或增强，请加在这个类中。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">推荐对Model进行Model级别Service层封装，方便扩展也是应对后续表结构发生变化时可以在Model的Service层进行协调或兼容。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">本框架中Model的Service可以自己实现，推荐直接继承框架提供的ModelService，后续框架增强Model层相关功能时能自动增强。见下面实例：</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```java title=&quot;ModelDemoService.java&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public interface ModelDemoService {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Demo getByName(String name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Demo getByNameFromTest(String name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    List&lt;Demo&gt; getAllByAge(int age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Page&lt;Demo&gt; getPageByAge(int page, int size, int age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Page&lt;Demo&gt; getPageByAgeWithGroupBy(int page, int size, int age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Page&lt;Demo&gt; getPageByFullSql(int page, int size, int age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Boolean addRecord(String name, int gender, int age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Boolean updateRecord(String name, int age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Boolean updateRecord(int id, int age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Boolean deleteRecord(String name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Boolean deleteRecord(int id);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">上面为Model的Service层接口类，通常Model的Service只对当前Model进行操作，即只对当前表进行操作。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```java title=&quot;ModelDemoServiceImpl.java&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class ModelDemoServiceImpl extends ModelService&lt;Demo&gt; implements ModelDemoService {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 返回结果是一个Demo对象。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Demo getByName(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String sql = &quot;select * from demo where name = ? limit 1&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return dao.findFirst(sql, name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 多数据源可以随时切换，use(&quot;test&quot;)切换到test数据源</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Demo getByNameFromTest(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String sql = &quot;select * from demo where name = ? limit 1&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return use(&quot;test&quot;).findFirst(sql, name);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 返回多行数据时，数据以Demo对象封装后以List&lt;Demo&gt;形式返回</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public List&lt;Demo&gt; getAllByAge(int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var sql = &quot;select * from demo where age &gt; ?&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return dao.find(sql, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 翻页查询时，以Page&lt;Demo&gt;形式返回，注意SQL语句分拆</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Demo&gt; getPageByAge(int page, int size, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return dao.paginate(page, size, &quot;select *&quot;, &quot;from demo where age &gt; ?&quot;, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 翻页查询支持GROUP BY，注意SQL语句分拆，MYSQL服务器需要关闭ONLY_FULL_GROUP_BY</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Demo&gt; getPageByAgeWithGroupBy(int page, int size, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return dao.paginate(page, size, true, &quot;select *&quot;, &quot;from demo where age &gt; ? group by age&quot;, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 翻页查询，完全自定义SQL查询，上面的查询会自动进行select count(*) ...查询，这里可以完全按需自定义</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Demo&gt; getPageByFullSql(int page, int size, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String from = &quot;from demo where age &gt; ?&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String totalRowSql = &quot;select count(*) &quot; + from;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String findSql = &quot;select * &quot; + from + &quot; order by age&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return dao.paginateByFullSql(page, size, totalRowSql, findSql, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 插入一条记录，创建一个Demo对象，设定需要的属性即字段值，然后直接save保存。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Boolean addRecord(String name, int gender, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return new Demo().setName(name).setGender(gender).setAge(age).save();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 按条件修改一条记录，按条件查询出要修改的Demo对象，设定需要修改的属性即字段值，然后直接update更新。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Boolean updateRecord(String name, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return dao.findFirst(&quot;select * from demo where name = ?&quot;, name).setAge(age).update();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 按ID修改一条记录，按ID查询出要修改的Demo对象，设定需要修改的属性即字段值，然后直接update更新。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Boolean updateRecord(int id, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return findById(id).setAge(age).update();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 按条件删除一条记录，按条件查询出要删除的Demo对象，然后直接delete删除。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Boolean deleteRecord(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return dao.findFirst(&quot;select * from demo where name = ?&quot;, name).delete();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // 按ID删除一条记录，按ID查询出要删除的Demo对象，然后直接delete删除。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Boolean deleteRecord(int id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return findById(id).delete();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">上面是ModelDemoService的实现类，演示了Model方式进行增删改查的使用。和Record方式有几分相似，但这里操作的对象是Demo模型，能以访问属性方式访问字段。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```java</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@RequestMapping(value = &quot;/model/&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class ModelController extends Controller {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    private ModelDemoService demoService;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;String&gt; index() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(&quot;hello world !&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Demo&gt; getByName() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByName(name));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Demo&gt; getByNameFromTest() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByNameFromTest(name));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;List&lt;Demo&gt;&gt; getAllByAge() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getAllByAge(age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Demo&gt;&gt; getPageByAge() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getPageByAge(page, size, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Demo&gt;&gt; getPageByAgeWithGroupBy() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getPageByAgeWithGroupBy(page, size, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Demo&gt;&gt; getPageByFullSql() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getPageByFullSql(page, size, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.POST)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; addRecord() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notNull(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int gender = Assert.notNull(getParamToInt(&quot;gender&quot;), &quot;gender is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.addRecord(name, gender, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.PUT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; updateRecord() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.updateRecord(name, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.PUT)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; updateRecordById() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int id = Assert.notNull(getParamToInt(&quot;id&quot;), &quot;id is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.updateRecord(id, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.DELETE)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; deleteRecord() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.deleteRecord(name));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping(method = RequestMethod.DELETE)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Boolean&gt; deleteRecordById() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int id = Assert.notNull(getParamToInt(&quot;id&quot;), &quot;id is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.deleteRecord(id));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">创建一个Controller来使用上面的ModelDemoService，通过访问`http://127.0.0.1:8080/model/...`即可查看结果。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## SQL模版</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">本框架支持使用SQL模版对SQL进行集中统一管理。在使用SQL模版前，需要先通过sqlTemplatePath和sqlTemplate配置好SQL模版存放路径和需要加载的SQL模版文件。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">也可以通过程序按需加载：</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```java</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class Main extends Application {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    protected void initialize() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 为test数据源加载sql模版</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Ready.dbManager().getDatasourceAgent(&quot;test&quot;).addSqlTemplate(&quot;sql/test.sql&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 设置test数据源为开发调试模式，此时SQL模版文件自定进行热加载，即修改SQL后不用重启应用即可立即生效。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Ready.dbManager().getDatasourceAgent(&quot;test&quot;).setDevMode(true);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public static void main(String[] args) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Ready.For(Main.class).Work(args);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">下面是demo.sql模版的内容：</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```sql</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#namespace(&quot;demo&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #sql(&quot;getByName&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      select * from demo where name = ? limit 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #sql(&quot;getByName_1&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      select * from demo where name = #param(0) and age &gt; #param(1) limit 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #sql(&quot;getByName_2&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      select * from demo where name = #param(name) and age &gt; #param(age) limit 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #sql(&quot;getByNameLike&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      select * from demo where name like concat(&#x27;%&#x27;, #param(0), &#x27;%&#x27;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #sql(&quot;getAllByPage&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      select * from demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #sql(&quot;getAllByDynamicParameter&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      select * from demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        #for(x : condition)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            #(for.first ? &quot;where&quot;: &quot;and&quot;) #(x.key) #param(x.value)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        #end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    #end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#end</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">其中用到了模版指令，#sql(&quot;sql标识&quot;)...#end为sql语句定义指令；#param(数字)和#param(参数名)为参数指令，分别用于按参数号和参数名获取参数的占位标识；#namespace(&quot;名称&quot;)...#end指令为 sql 语句指定命名空间，不同的命名空间可以让#sql指令使用相同的key值去定义sql，有利于模块化管理；#for(x:y)...#end是循环指令，用于遍历变量y；更多模版指令见Jfianl模版引擎文档`https://jfinal.com/doc/6-4`。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">下面我们实现一个服务类来使用上面的模版：</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```java</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class TemplateDemoService {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    private static Db db = Ready.dbManager().getDb();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Record getByName(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 获取上面SQL模版中名为getByName的sql语句</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var sql = db.getSql(&quot;demo.getByName&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.findFirst(sql, name); // 传入name，对应于sql语句中的 ? 占位符</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Record getByName_1(String name, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 获取上面SQL模版中名为getByName_1的sql语句，语句中的#param(0)和#param(1)，分别对应第0个参数name和第1个参数age</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var sql = db.getSqlParam(&quot;demo.getByName_1&quot;, name, age);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.findFirst(sql);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 可以使用下面template方法，更简洁，下面的方法等同上面2行代码</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        //return db.template(&quot;demo.getByName_1&quot;, name, age).findFirst();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Record getByName_2(String name, int age) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 获取上面SQL模版中名为getByName_2的sql语句，语句中的#param(name)和#param(age)，分别对应参数name和参数age</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        var sql = db.getSqlParam(&quot;demo.getByName_2&quot;, Kv.by(&quot;name&quot;, name).set(&quot;age&quot;, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.findFirst(sql);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 可以使用下面template方法，更简洁，下面的方法等同上面2行代码</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        //return db.template(&quot;demo.getByName_2&quot;, Kv.by(&quot;name&quot;, name).set(&quot;age&quot;, age)).findFirst();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public List&lt;Record&gt; getByNameLike(String name) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 获取上面SQL模版中名为getByNameLike的sql语句，演示模糊查询</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.template(&quot;demo.getByNameLike&quot;, name).find();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Record&gt; getAllByPage(int page, int size) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 获取上面SQL模版中名为getAllByPage的sql语句，演示翻页查询</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        SqlParam sqlParam = db.getSqlParam(&quot;demo.getAllByPage&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.paginate(1, 5, sqlParam);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 可以使用下面template方法，更简洁，下面的方法等同上面2行代码</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        //return db.template(&quot;demo.getAll&quot;).paginate(page, size);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Record&gt; getAllByParam(int page, int size, Object... param) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Assert.equals(0, param.length % 2, &quot;param should be in pairs&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        for(int i = 0; i &lt; param.length; i+=2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            map.put(param[i].toString(), param[i+1]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 获取上面SQL模版中名为getAllByDynamicParameter的sql语句，演示动态where多条件语句组装</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.template(&quot;demo.getAllByDynamicParameter&quot;, Kv.by(&quot;condition&quot;, map)).paginate(page, size);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Page&lt;Record&gt; getAllByParamFromTest(int page, int size, Object... param) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Assert.equals(0, param.length % 2, &quot;param should be in pairs&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        for(int i = 0; i &lt; param.length; i+=2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            map.put(param[i].toString(), param[i+1]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // test.sql中的内容是从demo.sql中复制了最后一个getAllByDynamicParameter语句，然后由程序配置加载，用于演示</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // 下面获取test.sql模版中名为getAllByDynamicParameter的sql语句，演示动态where多条件语句组装</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return db.use(&quot;test&quot;).template(&quot;test.getAllByDynamicParameter&quot;, Kv.by(&quot;condition&quot;, map)).paginate(page, size);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">下面创建一个Controller来使用上面的TemplateDemoService</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```java</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@RequestMapping(value = &quot;/template&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class TemplateController extends Controller {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    private TemplateDemoService demoService;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;String&gt; index() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(&quot;hello world !&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Record&gt; getByName() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByName(name));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Record&gt; getByName_1() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByName_1(name, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Record&gt; getByName_2() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int age = Assert.notNull(getParamToInt(&quot;age&quot;), &quot;age is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByName_2(name, age));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;List&lt;Record&gt;&gt; getByNameLike() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        String name = Assert.notEmpty(getParam(&quot;name&quot;), &quot;name is required&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getByNameLike(name));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Record&gt;&gt; getAllByPage() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getAllByPage(page,size));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Record&gt;&gt; getAllByParam() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getAllByParam(page, size, &quot;age &gt;&quot;, 15, &quot;height &gt;&quot;, 0));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @RequestMapping</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    public Result&lt;Page&lt;Record&gt;&gt; getAllByParamFromTest() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int page = getParamToInt(&quot;page&quot;, 1);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        int size = getParamToInt(&quot;size&quot;,5);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        return Success.of(demoService.getAllByParamFromTest(page, size, &quot;age &gt;&quot;, 15, &quot;height &gt;&quot;, 0));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">通过访问`http://127.0.0.1:8080/template/...`即可查看结果。</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">## H2数据库</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">框架集成支持H2数据库，一方面是为了方便小微应用可以一包走天下，另一方面是框架后续需要用到H2数据库。默认没有开启，可以通过如下方式开启使用：</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># configuration for dev environment</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">---</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">readyWork:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  server:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # This is the default binding address.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ip: 0.0.0.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    # Http port if enableHttp is true.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    httpPort: 8080</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  database:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sqlDebug: false # SQL调试，输出SQL到日志</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    h2server: # H2数据库设定</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      enabled: true # 开启H2数据库支持，即启动H2数据库</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      #tcpPort: 9092 # H2数据库的端口</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      #tcpAllowOthers: true # 是否允许其他电脑连接到H2数据库</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      #webPort: 8088 # H2的WEB管理端口</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      #webAllowOthers: true # 是否允许其他电脑访问H2的WEB管理页面</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dataSource: # 所有的数据源需要配置在dataSource下面</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      main: # 主数据源固定名称为&quot;main&quot;，其他数据源名称自定义</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type: mysql # 类型支持H2、Mysql、Postgre、Oracle、SqlServer、Sqlite、Ignite</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        #driverClass: com.mysql.cj.jdbc.Driver  #since mysql jdbc 8, The driver is automatically registered via the SPI</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        jdbcUrl: jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        username: root</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        password: 12345678</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        #autoMapping: true # 自动映射，默认开启</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        #table: demo # 单数据源或者程序手工映射时不需要此设定，只有多数据源时，自动映射模型需要明确模型表和数据源的关系，自动映射时，多数据源的表名不能重复，后续会改进该问题</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        #ignoreTable: xxx # 忽略某些表，如果有某些表是不需要该项目访问</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        #sqlTemplatePath: /sql/ # SQL模版文件路径，相对于项目工作空间路径，如果设置了此项，下面的sqlTemplate就相对于此路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        sqlTemplate: sql/demo.sql # 需要加载的SQL模版文件，如果上面sqlTemplatePath没有指明路径，这里需要带上相对于项目工作空间的路径</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      h2_1: # 如果h2server没有开启TCP端口，本机直接文件方式访问H2数据库</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type: h2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        driverClass: org.h2.Driver</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        jdbcUrl: jdbc:h2:/h2data/h2test # 这里的/h2data相对于项目工作空间目录，以h2test.mv.db的文件名存放在该目录下</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        username: root</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        password: 123456</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      h2_2: # 如果h2server开启了TCP端口，本机或其他机器可以通过TCP连接方式访问H2数据库</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        type: h2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        driverClass: org.h2.Driver</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        jdbcUrl: jdbc:h2:tcp://localhost:9092/h2data/h2prod # 这里的/h2data相对于项目工作空间目录，以h2prod.mv.db的文件名存放在该目录下</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        username: root</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        password: 123456</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">```</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LyuWeihua/ReadyWork/edit/master/website/docs/database.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh-CN/docs/validator"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 参数校验器</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh-CN/docs/database-auto"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">数据库-Auto注解 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#配置" class="table-of-contents__link">配置</a></li><li><a href="#演示数据" class="table-of-contents__link">演示数据</a></li><li><a href="#基本使用" class="table-of-contents__link">基本使用</a></li><li><a href="#代码生成器" class="table-of-contents__link">代码生成器</a></li><li><a href="#模型应用" class="table-of-contents__link">模型应用</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">开发文档</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/docs/">快速开始</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">源码仓库</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/LyuWeihua/ReadyWork" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">更多</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/blog">开发动态</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Ready.Work</div></div></div></footer></div>
<script src="/zh-CN/assets/js/styles.96f10285.js"></script>
<script src="/zh-CN/assets/js/runtime~main.419365fc.js"></script>
<script src="/zh-CN/assets/js/main.aa12cbc9.js"></script>
<script src="/zh-CN/assets/js/1.546c467a.js"></script>
<script src="/zh-CN/assets/js/2.b134721d.js"></script>
<script src="/zh-CN/assets/js/62.1a0d5637.js"></script>
<script src="/zh-CN/assets/js/64.5d0d37cb.js"></script>
<script src="/zh-CN/assets/js/935f2afb.305cabed.js"></script>
<script src="/zh-CN/assets/js/17896441.b6f4f76e.js"></script>
<script src="/zh-CN/assets/js/6a8a6f76.60bf0d64.js"></script>
</body>
</html>